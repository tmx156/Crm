/**
 * COMPREHENSIVE EMAIL FIX SCRIPT
 *
 * URGENT FIXES:
 * 1. Delete duplicate messages
 * 2. Fix corrupted/base64 encoded content
 * 3. Add unique constraint to prevent duplicates
 */

require('dotenv').config();
const { createClient } = require('./server/node_modules/@supabase/supabase-js');

const SUPABASE_URL = process.env.SUPABASE_URL || 'https://tnltvfzltdeilanxhlvy.supabase.co';
const SUPABASE_KEY = process.env.SUPABASE_KEY || 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRubHR2ZnpsdGRlaWxhbnhobHZ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcxOTk4MzUsImV4cCI6MjA3Mjc3NTgzNX0.T_HaALQeSiCjLkpVuwQZUFnJbuSyRy2wf2kWiqJ99Lc';
const supabase = createClient(SUPABASE_URL, SUPA